
def configs = [:]


ext.configs = configs




def addRepos(RepositoryHandler handler) {
    handler.maven { url "http://maven.aliyun.com/nexus/content/groups/public/" }
    handler.maven { url "https://maven.aliyun.com/repository/gradle-plugin" }
    handler.maven { url 'https://jitpack.io' }
    handler.jcenter()
    handler.google()
}

ext.addRepos = this.&addRepos

/**
 * Builds an Android version code from the version of the project.
 * @return the version code
 */
def buildVersionCode() {
//    def (major, minor, patch) = version.version.tokenize('.')
    def (ver, suffix) = version.toString().tokenize('-')
    def (major, minor, patch) = ver.tokenize('.')
    if (patch == null) {
        patch = 0
    }

    (major, minor, patch) = [major, minor, patch].collect {
        it.toInteger()
    }

    def b = 9999
    if (suffix != null) {
        def (stage, num, commits) = suffix.tokenize('.')
        b = num.toInteger()
    }


    if (b == 0) {
        b = 999
    }

    (major * 1000000) + (minor * 100000) + (patch * 10000) + b
}

ext.buildVersionCode = this.&buildVersionCode

/**
 * Builds an Android version name from the version of the project.
 * @return the version name
 */
def buildVersionName() {
//    def rtn = version.version
    def rtn = version.toString()
//    if (!version.isMaster) {
//        if (version.build == '0') {
//            rtn += ' (' + version.suffix + ')'
//        } else {
//            rtn += ' (b' + version.build + ')'
//        }
//    }

    rtn
}

ext.buildVersionName = this.&buildVersionName
